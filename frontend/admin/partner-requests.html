<!DOCTYPE html>
<html>
<head>
  <title>Partnerių užklausos</title>
  <style>
    .request-card { border: 1px solid #ccc; padding: 15px; margin: 10px; }
    table { width: 100%; border-collapse: collapse; }
    th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
    th { background-color: #f2f2f2; }
  </style>
</head>
<body>
  <table id="partner-requests">
    <thead>
      <tr>
        <th>Įmonė</th>
        <th>Svetainė</th>
        <th>El. paštas</th>
        <th>Užklausos data</th>
        <th>Veiksmai</th>
      </tr>
    </thead>
    <tbody>
      <!-- Čia bus užkraunamos užklausos -->
    </tbody>
  </table>

  <script>
    // Užkrauname laukiančius partnerius
    async function loadPendingPartners() {
      const response = await fetch('/api/partners/pending');
      const partners = await response.json();

      partners.forEach(partner => {
        const row = `
          <tr>
            <td>${partner.company}</td>
            <td><a href="${partner.website}" target="_blank">${partner.website}</a></td>
            <td>${partner.email}</td>
            <td>${new Date(partner.createdAt).toLocaleDateString()}</td>
            <td>
              <button onclick="approvePartner('${partner._id}')">Patvirtinti</button>
              <button onclick="rejectPartner('${partner._id}')">Atmesti</button>
            </td>
          </tr>
        `;
        document.querySelector('#partner-requests tbody').innerHTML += row;
      });
    }

    loadPendingPartners();

    async function approvePartner(id) {
      await fetch(`/api/partners/verify/${id}`, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ action: 'approve' })
      });
      loadPendingPartners(); // Perkrauti sąrašą
    }

    async function rejectPartner(id) {
      await fetch(`/api/partners/verify/${id}`, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ action: 'reject' })
      });
      loadPendingPartners();
    }
  </script>
</body>
</html>
